version: '3.7'

services:
  zeppelin-distribution:
    image: zeppelin-distribution
    command: package -U
    build:
      context: ./dist
      args: 
        - ZEPPELIN_BRANCH_VERSION=$ZEPPELIN_BRANCH_VERSION
        - ZEPPELIN_REPOSITORY=$ZEPPELIN_REPOSITORY
    environment:
      - MAVEN_PROJECT=$MAVEN_PROJECT
      - MAVEN_PROFILE=$MAVEN_PROFILE
    volumes:
      - "maven-repo:/root/.m2"
      - "distro:/workspace/zeppelin/zeppelin-distribution/target"

  zeppelin-binary:
    image: zeppelin
    build:
      context: ./binary
      args: 
        - ZEPPELIN_VERSION=$ZEPPELIN_VERSION

volumes:
  maven-repo:
  distro: